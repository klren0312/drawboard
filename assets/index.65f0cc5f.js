import{r as e,w as n,u as t,d as o,o as i,c as a,a as r,b as l,v as c,e as s,f as u,g as d,h as p,i as h}from"./vendor.2748488e.js";function w(e,n,t={}){if("function"!=typeof e)throw new Error("handle is not Function!");let{immediate:o=!1}=t;const{once:i=!1,debounce:a=!1}=t;let r,l=!1;function c(){r&&(window.clearTimeout(r),r=null)}function s(){c(),l=!0}return[function(...t){if(l)return;const u=()=>{!a&&c(),e.apply(this,t),i&&s()};if(o){o=!1;!r&&(u(),r=null)}else a&&c(),r&&!a||(r=setTimeout(u,n))},s]}function m(e,n,t={}){return w(e,n,t)}function f({el:o=window,name:i,listener:a,options:r,autoRemove:l=!0,isDebounce:c=!0,wait:s=80}){let u=()=>{};const d=e(!1);if(o){const p=e(o),[h]=c?function(e,n,t={}){return m(e,n,Object.assign(t,{debounce:!0}))}(a,s):m(a,s),w=s?h:a,f=e=>{d.value=!0,e.removeEventListener(i,w,r)},v=e=>e.addEventListener(i,w,r),g=n(p,((e,n,o)=>{e&&(!t(d)&&v(e),o((()=>{l&&f(e)})))}),{immediate:!0});u=()=>{f(p.value),g()}}return{removeEvent:u}}!function(e=".",n="__import__"){try{self[n]=new Function("u","return import(u)")}catch(t){const o=new URL(e,location),i=e=>{URL.revokeObjectURL(e.src),e.remove()};self[n]=e=>new Promise(((t,a)=>{const r=new URL(e,o);if(self[n].moduleMap[r])return t(self[n].moduleMap[r]);const l=new Blob([`import * as m from '${r}';`,`${n}.moduleMap['${r}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){a(new Error(`Failed to import: ${e}`)),i(c)},onload(){t(self[n].moduleMap[r]),i(c)}});document.head.appendChild(c)})),self[n].moduleMap={}}}("/drawboard/assets/");var v=o({name:"DrawBoard",setup:()=>{let n,t,o,a=e("#000"),r=!1,l=[],c={x:0,y:0},s=e(!1);function u(e){if(console.log("cancel"),o=-1,!r)return!1;r=!1,l.push(t.getImageData(0,0,n.width,n.height)),t.closePath()}function d(e,n=!1){if(s.value&&"pen"!==e.pointerType)return;const o=e||window.event,i=o.offsetX,r=o.offsetY;t.lineWidth=function(e){switch(e.pointerType){case"touch":return e.width<10&&e.height<10?2*(e.width+e.height)+10:(e.width+e.height-40)/2;case"pen":return 8*e.pressure;default:return e.pressure?8*e.pressure:4}}(o),t.strokeStyle=a.value,t.beginPath(),n?t.moveTo(i,r):(t.moveTo(c.x,c.y),t.lineTo(i,r)),t.closePath(),t.stroke(),c={x:i,y:r}}return i((()=>{!function(){n=document.getElementById("canvas"),t=n.getContext("2d");let e=window.innerWidth,i=window.innerHeight;window.devicePixelRatio&&(n.style.width=e+"px",n.style.height=i+"px",n.height=i*window.devicePixelRatio,n.width=e*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio));t.imageSmoothingEnabled=!0,f({el:n,name:"pointerdown",isDebounce:!1,wait:0,listener:e=>function(e){r=!0,o=e.pointerId,t.lineCap="round",t.lineJoin="round",d(e,!0)}(e)}),f({el:n,name:"pointermove",isDebounce:!1,wait:0,listener:e=>function(e){if(!r&&e.pointerId!==o)return;d(e)}(e)}),f({el:n,name:"pointerup",isDebounce:!1,wait:0,listener:e=>u()}),f({el:n,name:"pointerleave",isDebounce:!1,wait:0,listener:e=>u()})}()})),{undoHandle:function(){t.clearRect(0,0,n.width,n.height);try{l.pop();const e=l[l.length-1];e?t.putImageData(e,0,0):t.clearRect(0,0,n.width,n.height)}catch(e){t.clearRect(0,0,n.width,n.height)}},clearHandle:function(){t.clearRect(0,0,n.width,n.height)},isPen:s,lineColor:a}}});const g={class:"canvas-block"},b=r("canvas",{id:"canvas"},null,-1),y={class:"group-btn"},R=u("笔模式");v.render=function(e,n){return d(),a("div",g,[b,r("div",y,[r("button",{onClick:n[1]||(n[1]=(...n)=>e.undoHandle&&e.undoHandle(...n))},"后退"),r("button",{onClick:n[2]||(n[2]=(...n)=>e.clearHandle&&e.clearHandle(...n))},"清空"),r("label",null,[l(r("input",{type:"checkbox","onUpdate:modelValue":n[3]||(n[3]=n=>e.isPen=n)},null,512),[[c,e.isPen]]),R]),l(r("input",{type:"color","onUpdate:modelValue":n[4]||(n[4]=n=>e.lineColor=n)},null,512),[[s,e.lineColor]])])])};var x=o({name:"App",components:{DrawBoard:v}});x.render=function(e,n,t,o,i,r){const l=p("DrawBoard");return d(),a(l)},h(x).mount("#app");
